---
title: "Data_Vis"
author: "Rachael E. Blake"
date: "May 1, 2017"
output:
  pdf_document: default
  html_document: default
---

```{r, include=FALSE, echo=FALSE, results='hide'}
library(ggplot2) ; library(tidyverse)

```

#PDO
```{r, echo=FALSE, include=FALSE}
source("PDO_cleaning.r")

# dataframes are pdo_mon and pdo_ann

pdo_mon_adj <- pdo_mon %>%
               mutate(Month_number = forcats::fct_recode(Month, "01"="JAN", "02"="FEB", "03"="MAR",
                                                                "04"="APR", "05"="MAY", "06"="JUN", 
                                                                "07"="JUL", "08"="AUG", "09"="SEP", 
                                                                "10"="OCT", "11"="NOV", "12"="DEC"),
                      Yr_Mn = paste(Year, Month_number, sep="-"),
                      Sign = ifelse(PDO>0, "A", "B"))
               
```

```{r, echo=FALSE}
#
pdo_plot <- ggplot(data=pdo_mon, aes(x=Year, y=PDO)) + geom_col() + 
            geom_hline(yintercept=0, size=1.5) + ylab("PDO Index")

  
#
pdo_plot2 <- ggplot(data=pdo_mon_adj, aes(x=Yr_Mn, y=PDO)) + 
             geom_col(aes(fill=Sign), show.legend=FALSE) + xlab("Year") +
             geom_hline(yintercept=0, size=1) + ylab("PDO Index") + 
             scale_x_discrete(breaks=c("1999-01", "2000-01", "2001-01", "2002-01", "2003-01", "2004-01",
                                       "2005-01", "2006-01", "2007-01", "2008-01", "2009-01", "2010-01",
                                       "2011-01", "2012-01", "2013-01", "2014-01", "2015-01", "2016-01"),
                              labels=c("1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", 
                                       "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014",
                                       "2015", "2016"))

```

#Invertebrates: Percent Cover Data
```{r, include=FALSE, echo=FALSE, results='hide'}
# source the data cleaning script
source("Data_Cleaning_K_Bay.r")

# dataframe is called PerCov_clean

PerCov_long <- PerCov_clean %>%
               gather(Taxa, Percent_Cover, -standard_code, -plot, -abbr_code, -Year, -Block, -Treatment)

PerCov_anom <- PerCov_long %>%
               group_by(Taxa) %>%
               mutate(Taxa_Mean = mean(Taxa),
                      Taxa_Anom = Taxa_Mean-Taxa) %>%
               ungroup()

```

```{r, echo=FALSE}
explore_plots <- function(y_var){
                 p <- ggplot(data=PerCov_clean, aes_string(x="Year", y=y_var, fill="Treatment")) + 
                      geom_boxplot() + theme(legend.position="top", legend.title=element_blank()) +
                      scale_fill_manual(breaks=c("01","99","00","10"),
                                        labels=c("Control","Treatment 1","Treatment 2","10"),
                                        values=c("#086d44","#2d348f","#fc7307","#a8148b"))
                 return(p)
}


```

```{r, echo=FALSE, fig.height=3.5, fig.width=7}
# Fucus Total
# ft <- explore_plots("FUCUS_TOTAL")
# ft

# make a plot for each variable
var_names <- names(PerCov_clean[,c(4:28)]) 

lapply(var_names, function(x) FUN=explore_plots(y_var=x))

```

```{r, echo=FALSE}



```





